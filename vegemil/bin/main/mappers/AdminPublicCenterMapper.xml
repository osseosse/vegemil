<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.vegemil.mapper.AdminPublicCenterMapper">
	<!-- 보도자료 등록 -->
	<insert id= "insertMediaNews" parameterType="com.vegemil.domain.AdminMediaNewsDTO">
	INSERT INTO m_media_news(
		m_subject,
		m_date,
		m_img,
		m_img_original,
		m_adname1, m_aduri1,
		m_adname2, m_aduri2,
		m_adname3, m_aduri3,
		m_adname4, m_aduri4,
		m_adname5, m_aduri5,
		m_adname6, m_aduri6,
		m_adname7, m_aduri7,
		m_adname8, m_aduri8,
		m_adname9, m_aduri9,
		m_adname10, m_aduri10	
	)VALUES(
		#{mSubject},
		#{mDate},
		#{mImg},
		#{mImgOriginal},
		#{mAdname1}, #{mAduri1},
		#{mAdname2}, #{mAduri2},
		#{mAdname3}, #{mAduri3},
		#{mAdname4}, #{mAduri4},
		#{mAdname5}, #{mAduri5},
		#{mAdname6}, #{mAduri6},
		#{mAdname7}, #{mAduri7},
		#{mAdname8}, #{mAduri8},
		#{mAdname9}, #{mAduri9},
		#{mAdname10}, #{mAduri10}	
	)	
	</insert>



	<!-- 보도자료 수 -->
	<select id="selectMediaNewsTotalCount" parameterType="hashMap" resultType="int">
		SELECT 
			COUNT(*)
		FROM
			m_media_news
		WHERE 1=1
		<if test='sStartdate != "" '>
	 	   AND m_date &gt;= DATE(#{sStartdate, jdbcType=VARCHAR})
	 	</if>
	 	<if test='sEnddate != "" '>
	 	   AND m_date &lt;= DATE(#{sEnddate, jdbcType=VARCHAR})+1
	 	</if>
	 	<if test='gubun == "1" '>
	 		AND m_display = 1
	 	</if>
	 	<if test='gubun == "2" '>
	 		AND m_display = 2
	 	</if>
	 	<if test='searchWord'>
			AND m_subject LIKE CONCAT('%', #{searchWord, jdbcType=VARCHAR}, '%') OR m_content LIKE CONCAT('%', #{searchWord, jdbcType=VARCHAR}, '%')
		</if>
	</select>
		
	<select id="selectMediaNewsList"  parameterType="hashMap" resultType="com.vegemil.domain.AdminMediaNewsDTO">
		SELECT
			m_idx, m_subject, m_img,
			CONCAT(m_adname1," " ,m_adname2," " ,m_adname3," " ,m_adname4," " ,m_adname5," " ,m_adname6," " ,m_adname7," " ,m_adname8," " ,m_adname9," " ,m_adname10) AS m_adname,
			DATE_FORMAT(m_date, "%Y-%m-%d") m_date, m_hit	
		FROM 
			m_media_news
		WHERE 1 = 1
	    <if test='sStartdate != "" '>
	 	   AND m_date &gt;= DATE(#{sStartdate, jdbcType=VARCHAR})
	 	</if>
	 	<if test='sEnddate != "" '>
	 	   AND m_date &lt;= DATE(#{sEnddate, jdbcType=VARCHAR})+1
	 	</if>
	 	<if test='gubun == "1" '>
	 		AND m_display = 1
	 	</if>
	 	<if test='gubun == "2" '>
	 		AND m_display = 2
	 	</if>
	 	<if test='searchWord != null and !searchWord.equals("")'>
			AND m_subject LIKE CONCAT('%', #{searchWord, jdbcType=VARCHAR}, '%') OR m_content LIKE CONCAT('%', #{searchWord, jdbcType=VARCHAR}, '%')
		</if>
		 ORDER BY m_idx DESC
		 LIMIT #{start, jdbcType=INTEGER}, #{length, jdbcType=INTEGER}
	</select>
	
	
	<update id="deleteMediaNews" parameterType="hashMap">
		DELETE FROM m_media_news
		 WHERE m_idx IN
      <foreach collection='list' index='index' item='idx' open='(' close=')' separator=','> 
		 #{idx, jdbcType=VARCHAR}
	  </foreach>
	</update>
	
	
	
	<select id="selectMediaNews" parameterType="long" resultType="com.vegemil.domain.AdminMediaNewsDTO">
		SELECT 
			m_idx,
			m_subject,
			m_date,
			m_img,
			m_img_original,
			m_adname1, m_aduri1,
			m_adname2, m_aduri2,
			m_adname3, m_aduri3,
			m_adname4, m_aduri4,
			m_adname5, m_aduri5,
			m_adname6, m_aduri6,
			m_adname7, m_aduri7,
			m_adname8, m_aduri8,
			m_adname9, m_aduri9,
			m_adname10, m_aduri10
		FROM
			m_media_news
		WHERE
			m_idx = #{mIdx}
	</select>
	
	<!-- 첨부파일 조회 - 원본명 -->
	<select id="selectImgFileOriginal" parameterType="long" resultType="String">
		SELECT 
			m_img_original 
		FROM 
			m_media_news 			
		WHERE
			m_idx = #{mIdx}
	</select>
	
	<!-- 첨부파일 조회 - 변환명 -->
	<select id="selectImgFile" parameterType="long" resultType="String">
		SELECT 
			m_img 
		FROM 
			m_media_news 			
		WHERE
			m_idx = #{mIdx}
	</select>
	
	<update id="updateFileInfo" parameterType="long">
		UPDATE 
			m_media_news 
		SET 
			m_img = DEFAULT, m_img_original = DEFAULT
		WHERE 
			m_idx = #{mIdx}  	
	</update>
	
	<update id="updateMediaNews" parameterType="com.vegemil.domain.AdminMediaNewsDTO">
		UPDATE 
			m_media_news 
		SET 
			m_subject = #{mSubject},
			m_date = #{mDate},
			<if test='mImg!=null and !mImg.equals("")'>
	 	   		m_img = #{mImg},
	 		</if>	
	 		<if test='mImgOriginal!=null and !mImgOriginal.equals("")'>
	 	   		m_img_original = #{mImgOriginal},
	 		</if>	
			m_adname1 = #{mAdname1}, m_aduri1 = #{mAduri1},
			m_adname2 = #{mAdname2}, m_aduri2 = #{mAduri2},
			m_adname3 = #{mAdname3}, m_aduri3 = #{mAduri3},
			m_adname4 = #{mAdname4}, m_aduri4 = #{mAduri4},
			m_adname5 = #{mAdname5}, m_aduri5 = #{mAduri5},
			m_adname6 = #{mAdname6}, m_aduri6 = #{mAduri6},
			m_adname7 = #{mAdname7}, m_aduri7 = #{mAduri7},
			m_adname8 = #{mAdname8}, m_aduri8 = #{mAduri8},
			m_adname9 = #{mAdname9}, m_aduri9 = #{mAduri9},
			m_adname10 = #{mAdname10}, m_aduri10 = #{mAduri10}				
		WHERE 
			m_idx = #{mIdx}  	
	</update>
	
	
	
	
	<!-- <resultMap type="com.vegemil.mapper.AdminPublicCenterMapper" id="selectMediaNewsList">
        <result property="mHit" column="m_hit"/>
        
    </resultMap> -->
	
	

</mapper>